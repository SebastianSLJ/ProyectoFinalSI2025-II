<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Métricas Musicales</title>
    <link rel="stylesheet" href="../static/css/panel.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h1>La Iglesia Bar</h1>
                <p>Panel de Administración</p>
            </div>
            <ul class="nav-links">
                <li><a href="/panel.html" class="active"> Dashboard</a></li>
                <li><a href="#"> Canciones</a></li>
                <li><a href="/metricas"> Métricas</a></li>
                <li><a href="#"> Aforo</a></li>
                <li><a href="#"> Ventas</a></li>
                <li><a href="#"> Configuración</a></li>
            </ul>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1>Métricas Musicales</h1>
                <div class="date-filter">
                    <select id="time-range">
                        <option value="7">Últimos 7 días</option>
                        <option value="30" selected>Últimos 30 días</option>
                        <option value="90">Últimos 3 meses</option>
                    </select>
                    <button id="apply-filter">Aplicar</button>
                </div>
            </div>
            
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Puntuación Promedio</h3>
                    <div class="value">--/10</div>
                    <div class="trend neutral"></div>
                </div>
                <div class="stat-card">
                    <h3>Impacto en Ventas</h3>
                    <div class="value">--%</div>
                    <div class="trend neutral"></div>
                </div>
                <div class="stat-card">
                    <h3>Aforo Promedio</h3>
                    <div class="value">--%</div>
                    <div class="trend neutral"></div>
                </div>
                <div class="stat-card">
                    <h3>Canciones Analizadas</h3>
                    <div class="value">--</div>
                    <div class="trend neutral"></div>
                </div>
            </div>
          
            <!-- Charts Grid -->
            <div class="charts-grid">
                <div class="chart-card">
                    <h2>Relación Música-Ventas
                        <span style="font-size: 14px; color: #b3b3b3;">Últimos 30 días</span>
                    </h2>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <h2>Géneros Más Efectivos</h2>
                    <div class="chart-container">
                        <canvas id="genresChart"></canvas>
                    </div>
                </div>
            </div>

             <!-- Panel de detalles del día (inicialmente oculto) -->
            <div id="detalle-dia-panel" class="detalle-panel" style="display: none;">
                <div class="detalle-header">
                    <h2 id="detalle-titulo">Detalles del Día</h2>
                    <button class="close-btn" onclick="cerrarDetallePanel()">✕</button>
                </div>
                
                <div class="detalle-stats">
                    <div class="detalle-stat">
                        <span class="detalle-label">Reproducciones</span>
                        <span class="detalle-value" id="detalle-reproducciones">--</span>
                    </div>
                    <div class="detalle-stat">
                        <span class="detalle-label">Impacto Promedio</span>
                        <span class="detalle-value positive" id="detalle-impacto">--%</span>
                    </div>
                    <div class="detalle-stat">
                        <span class="detalle-label">Puntuación</span>
                        <span class="detalle-value" id="detalle-puntuacion">--/10</span>
                    </div>
                    <div class="detalle-stat">
                        <span class="detalle-label">Aforo</span>
                        <span class="detalle-value" id="detalle-aforo">--%</span>
                    </div>
                </div>
                
                <div class="detalle-horas">
                    <h3>Horas Pico</h3>
                    <div id="horas-pico-container" class="horas-badges">
                        <!-- Se llenarán dinámicamente -->
                    </div>
                </div>
                
                <div class="detalle-canciones">
                    <h3>Canciones Más Reproducidas</h3>
                    <table class="detalle-table">
                        <thead>
                            <tr>
                                <th>Canción</th>
                                <th>Reproducciones</th>
                                <th>Puntuación</th>
                                <th>Impacto</th>
                            </tr>
                        </thead>
                        <tbody id="detalle-canciones-body">
                            <!-- Se llenará dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Songs Table -->
            <div class="songs-table">
                <div class="table-header">
                    <h2>Canciones Más Influyentes</h2>
                    <div class="date-filter">
                        <select>
                            <option>Por Puntuación</option>
                            <option>Por Impacto en Ventas</option>
                            <option>Por Reproducciones</option>
                        </select>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Canción</th>
                            <th>Artista</th>
                            <th>Reproducciones</th>
                            <th>Puntuación</th>
                            <th>Impacto Ventas</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="song-info">
                                    <img src="https://i.scdn.co/image/ab67616d0000b2734c71e27f7c5c0c7d5b4a7f8a" class="song-img">
                                    <div>
                                        <div>Blinding Lights</div>
                                        <div style="font-size: 12px; color: #b3b3b3;">After Hours</div>
                                    </div>
                                </div>
                            </td>
                            <td>The Weeknd</td>
                            <td>24</td>
                            <td>
                                <div class="rating">
                                    <div class="stars">★★★★★</div>
                                    <div>9.2/10</div>
                                </div>
                            </td>
                            <td class="positive">+22%</td>
                        </tr>
                        <tr>
                            <td>
                                <div class="song-info">
                                    <img src="https://i.scdn.co/image/ab67616d0000b2738863bc11d2aa12b54f5aeb36" class="song-img">
                                    <div>
                                        <div>Save Your Tears</div>
                                        <div style="font-size: 12px; color: #b3b3b3;">After Hours</div>
                                    </div>
                                </div>
                            </td>
                            <td>The Weeknd</td>
                            <td>18</td>
                            <td>
                                <div class="rating">
                                    <div class="stars">★★★★☆</div>
                                    <div>8.5/10</div>
                                </div>
                            </td>
                            <td class="positive">+18%</td>
                        </tr>
                        <tr>
                            <td>
                                <div class="song-info">
                                    <img src="https://i.scdn.co/image/ab67616d0000b2732e8ed79e177ff6011076f5f0" class="song-img">
                                    <div>
                                        <div>Levitating</div>
                                        <div style="font-size: 12px; color: #b3b3b3;">Future Nostalgia</div>
                                    </div>
                                </div>
                            </td>
                            <td>Dua Lipa</td>
                            <td>22</td>
                            <td>
                                <div class="rating">
                                    <div class="stars">★★★★☆</div>
                                    <div>8.7/10</div>
                                </div>
                            </td>
                            <td class="positive">+20%</td>
                        </tr>
                        <tr>
                            <td>
                                <div class="song-info">
                                    <img src="https://i.scdn.co/image/ab67616d0000b2731c1ea7bfc442ecd6c6c8e7e0" class="song-img">
                                    <div>
                                        <div>Good 4 U</div>
                                        <div style="font-size: 12px; color: #b3b3b3;">SOUR</div>
                                    </div>
                                </div>
                            </td>
                            <td>Olivia Rodrigo</td>
                            <td>15</td>
                            <td>
                                <div class="rating">
                                    <div class="stars">★★★☆☆</div>
                                    <div>6.8/10</div>
                                </div>
                            </td>
                            <td class="negative">-5%</td>
                        </tr>
                        <tr>
                            <td>
                                <div class="song-info">
                                    <img src="https://i.scdn.co/image/ab67616d0000b273b1c4b76e23414c9f20242268" class="song-img">
                                    <div>
                                        <div>Stay</div>
                                        <div style="font-size: 12px; color: #b3b3b3;">Stay</div>
                                    </div>
                                </div>
                            </td>
                            <td>The Kid LAROI, Justin Bieber</td>
                            <td>20</td>
                            <td>
                                <div class="rating">
                                    <div class="stars">★★★★☆</div>
                                    <div>8.0/10</div>
                                </div>
                            </td>
                            <td class="positive">+12%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/panel.js') }}" defer></script>
</body>
</html>